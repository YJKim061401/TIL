## 컨볼루션 신경망 모델에서 주로 사용되는 레이어들

### Conv2D 

```python
Conv2D(32,(3,3),activation='relu',input_shape=(64,64,3),padding='valid')
```

* 첫번째 인자 : 컨볼루션 필터의 수. 출력 특성 맵의 깊이 차원을 결정
* 두번째 인자 : 컨볼루션 커널의 (행,열)
* activation : 활성함수 설정
  * 'linear' : 디폴트 값
  * 'relu' : 은닉층에 주로 쓰임
  * 'sigmoid' : 이진 분류 문제에서 출력층에 주로 쓰임
  * 'softmax' : 다중 분류 문제에서 출력층에 주로 쓰임 
* Input_shape : 샘플 수를 제외한 입력 형태를 정의 
  * (행,열,채널수)
* padding : 경계 처리 방법을 정의
  * 'valid' : 유효한 영역만 출력. 출력 이미지 사이즈는 입력 사이즈보다 작음
  * 'same' : 출력 이미지 사이즈가 입력 이미지 사이즈와 동일 
    * 입력 이미지에 경계를 학습시키는 효과 

* 합성곱 연산은 입력 특성 맵에서 작은 패치를 추출하고 이런 모든 패치에 같은 변환을 적용하여 출력 특성 맵을 만듦
* 깊이 축의 채널은 필터를 의미
* 필터 : 입력 데이터의 어떤 특성을 인코딩 e.g. 하나의 필터가 '입력에 어떤 얼굴이 있는지'를 인코딩
* e.g. 합성곱 층이 (64,64,3) 크기의 특성 맵을 입력으로 받아 (62,62,32) 크키의 특성 맵을 출력
* 즉 입력에 대해 32개의 필터를 적용 
* 32개의 출력 채널은 각각 62x62 크기의 배열 값을 가짐
* 이 배열 값은 입력에 대한 필터의 응답 맵 : 입력의 각 위치에서 필터 패턴에 대한 응답을 나타냄
* <img src="/Users/yeji/Library/Application Support/typora-user-images/Screenshot 2021-08-14 at 12.28.34 AM.png" alt="Screenshot 2021-08-14 at 12.28.34 AM" style="zoom:33%;" />





### Max Pooling

* 컨볼루션 레이어의 출력 이미지에서 주요값만 뽑아 크기가 작은 출력 영상을 만듦

```python
model.add(MaxPooling2D((2,2)))
```

* Pool_size : 수직, 수평 축소 비율 지정 (2,2)이면 출력 영상 크기는 입력 영상 크기의 반으로 줄어듦 

> 이 레이어는 영상의 작은 변화라던지 사소한 움직임이 특징을 추출할 때 크게 영향을 미치지 않도록 합니다. 영상 내에 특징이 세 개가 있다고 가정했을 때, 아래 그림에서 첫 번째 영상을 기준으로 두 번째 영상은 오른쪽으로 이동하였고, 세 번째 영상은 약간 비틀어 졌고, 네 번째 영상은 조금 확대되었지만, 맥스풀링한 결과는 모두 동일합니다. 얼굴 인식 문제를 예를 들면, 맥스풀링의 역할은 사람마다 눈, 코, 입 위치가 조금씩 다른데 이러한 차이가 사람이라고 인식하는 데 있어서는 큰 영향을 미치지 않게 합니다.

참고 : https://tykimos.github.io/2017/01/27/CNN_Layer_Talk/



### Flatten

* 2차원 -> 1차원으로 변환하는 함수